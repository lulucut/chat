"use strict";function formatDate(){var t=new Date;return t.getFullYear()+"/"+t.getMonth()+"/"+t.getDate()+"  "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}var send=document.getElementById("send"),img=new Image,Chat=function(){function t(){this.socket=null,this.init()}function n(t){c.text(t.size),t.flag?r.get(0).appendChild(s('<div class="user-in">\n\t\t\t\t欢迎\n\t\t\t\t<img class="user-img" src="images/face.jpeg" />\n\t\t\t\t<strong class="user-name">'+t.pickname+"</strong> \n\t\t\t\t加入群聊！\n\t\t\t</div>")):r.get(0).appendChild(s('<div class="chat-info">\n\t\t\t\t<img class="user-normal-img" src="images/face.jpeg" />\n\t\t\t\t<span class="time">\n\t\t\t\t\t<strong class="user-name">system</strong>\n\t\t\t\t\t'+formatDate()+'\n\t\t\t\t</span>\n\t\t\t\t<span class="message">\n\t\t\t\t\t用户 '+t.pickname+" 已经离开群聊\n\t\t\t\t</span>\n\t\t\t</div>"))}function e(){a=L(".info"),c=L("#peopel"),r=L(".msg"),l=L("#pickname")}function s(t){return o.innerHTML=t,o.childNodes[0]}var i=t.prototype,o=document.createElement("div"),a=null,c=null,r=null,l=null,u=!1;return i.init=function(){var t=this;this.socket=io.connect(),this.socket.on("connect",function(){L(".loading").css({display:"none"}),L(".enter-name").css({display:"block"}),e(),t.login(),t.system()})},i.login=function(){var t=this;L("#send-name").click(function(){var n=l.val();n.trim()?t.socket.emit("login",n):a.text("your pickname can't be blank or just spaces")}),this.socket.on("loginSuccess",function(){u=!0,L("#mask").css({display:"none"})}),this.socket.on("repeat",function(){a.text("your pickname is token, please use another")})},i.system=function(){this.socket.on("system",function(t){u&&n(t)})},t}();L(window).load(function(){new Chat,img.src="images/face.jpeg",img.onerror=function(){this.src="images/logo.png"}});